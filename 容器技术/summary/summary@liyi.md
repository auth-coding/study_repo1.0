# 容器技术

## docker

### docker出现的历史背景

* 开发环境和生产环境的不一致，提高了部署的成本，难度，出错率等。
* 重新部署会遇到同样的问题
* 部署一个应用需要用到一个服务器(至少)，当应用访问量低时，极大浪费服务器的资源，同时当应用访问量高时，不好做横向扩展。
* 虚拟机技术
* lxc， linux容器技术

### docker的好处

* 将程序需要的各种依赖和系统环境一起打包，保证开发环境和生产环境的一致，就不会出现部署错误，
* 重新部署只需要使用上次的打包即可，
* docker打包的容器是单独运行一个服务器物理机上的，可以看做服务器上运行的一个程序，而这个程序就像一个虚拟机，容器里可以独立运行应用程序，
而docker容器和虚拟机的区别，虚拟机是对物理机的完全虚拟，你在虚拟机上甚至感受不到和物理机的区别，比如虚拟机上也会有对打印机接口，硬盘，光驱等硬件的模仿，而容器只会维护一个可以运行应用程序的最简计算机系统，并且容器内存和cpu，带宽等都可以根据应用程序的使用情况而动态伸缩扩容，而且一个服务器可以运行多个容器，极大地节省了服务器资源，而对大型的应用的集群和分布式部署，没有任何影响。


### docker的三大概念

* 镜像，镜像就像对一个可运行指定程序应用的计算机环境的打包压缩，
包括计算机操作系统，程序相关环境依赖，以及源代码(包含程序运行的所有必要条件)，
一个web应用程序的镜像基本只用200-300Mb，相比虚拟机和物理机服务器，
大大节省了磁盘空间

> 了解镜像，还需要了解一个前置概念，Dockerfile，也是在真正需要附带在程序里的docker配置

* 容器， 容器是一个正在运行某个应用程序的而计算机环境，直白而言，
容器就是运行时镜像，物理机--虚拟机--容器，是一个逐渐精简的概念。
> docker run -option image_name

* 仓库， 仓库类似github的仓库，即存放源代码文件的代码仓库，而docker仓库
则是存储docker镜像，docker-hub则存在许多线上仓库，里面的有许多现成的docker
镜像可以使用
> 可以使用现成的docker镜像，也可以继承别人的镜像，再增加额外的配置
这正是通过编写Dockerfile实现的。

#### docker镜像的来源

* 使用Dockerfile构建,
> docker build [options] [tag] path  
指定目录下的Dockerfile去构建镜像

* 使用当前运行容器，打包镜像
> docker commit -m  "描述"   -a  "作者信息"   [CONTAINER ID]  [给新的镜像命名]  
容器是由镜像启动而来，但是 容器就像一个远程服务器，可以进入容器的终端进行
各种操作，从而改变容器的状态，可以打包成新的镜像，并将镜像上传到仓库，
供继承使用。
